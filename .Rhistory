p1<- ggplot(map_data, aes(x = long, y = lat, group = group,
text = sprintf("region: %s<br>total litres of pure alcohol: %s",
region, total_litres_of_pure_alcohol)))+
geom_polygon( aes(fill = total_litres_of_pure_alcohol), color = "white")+
scale_fill_gradient(low = "#e0ecf4",
high = "#4d004b",
na.value = "grey",
breaks = c(0,2,4,6,8,10,12,14),
labels = c(0,2,4,6,8,10,12,14))+
theme_void()+
labs(fill = "Litres",
title = "Figure1: Global alcohol consumption")+
xlab(
"NA value: grey;
Litres: Total litres of pure alcohol")
ggplotly(p1, tooltip = "text")
ggplot(map_data, aes(x = long, y = lat, group = group,
text = sprintf("region: %s<br>beer servings: %s",
region, beer_servings)))+
geom_polygon( aes(fill = beer_servings), color = "white")+
scale_fill_gradient(low = "#e0ecf4",
high = "#4d004b",
na.value = "grey")+
theme_void()+
labs(fill = "Servings",
title = "Figure3: Beer global alcohol consumption",
caption = "NA value: grey;
Servings: beer servings")
ggplot(map_data, aes(x = long, y = lat, group = group,
text = sprintf("region: %s<br>beer servings: %s",
region, beer_servings)))+
geom_polygon( aes(fill = beer_servings), color = "white")+
scale_fill_gradient(low = "#e0ecf4",
high = "#4d004b",
na.value = "grey",
n.breaks = 5)+
theme_void()+
labs(fill = "Servings",
title = "Figure3: Beer global alcohol consumption",
caption = "NA value: grey;
Servings: beer servings")
ggplot(map_data, aes(x = long, y = lat, group = group,
text = sprintf("region: %s<br>beer servings: %s",
region, beer_servings)))+
geom_polygon( aes(fill = beer_servings), color = "white")+
scale_fill_gradient(low = "#e0ecf4",
high = "#4d004b",
na.value = "grey",
breaks = c(0,50,100,150,200,250,300,350,400),
labels = c(0,50,100,150,200,250,300,350,400))+
theme_void()+
labs(fill = "Servings",
title = "Figure3: Beer global alcohol consumption",
caption = "NA value: grey;
Servings: beer servings")
ggplot(map_data, aes(x = long, y = lat, group = group,
text = sprintf("region: %s<br>beer servings: %s",
region, beer_servings)))+
geom_polygon( aes(fill = beer_servings), color = "white")+
scale_fill_gradient(low = "#e0ecf4",
high = "#4d004b",
na.value = "grey",
breaks = c(0,50,100,150,200,250,300,400),
labels = c(0,50,100,150,200,250,300,400))+
theme_void()+
labs(fill = "Servings",
title = "Figure3: Beer global alcohol consumption",
caption = "NA value: grey;
Servings: beer servings")
ggplot(map_data, aes(x = long, y = lat, group = group,
text = sprintf("region: %s<br>beer servings: %s",
region, beer_servings)))+
geom_polygon( aes(fill = beer_servings), color = "white")+
scale_fill_gradient(low = "#e0ecf4",
high = "#4d004b",
na.value = "grey",
breaks = c(0,100,150,200,250,300,400),
labels = c(0,100,150,200,250,300,400))+
theme_void()+
labs(fill = "Servings",
title = "Figure3: Beer global alcohol consumption",
caption = "NA value: grey;
Servings: beer servings")
ggplot(map_data, aes(x = long, y = lat, group = group,
text = sprintf("region: %s<br>beer servings: %s",
region, beer_servings)))+
geom_polygon( aes(fill = beer_servings), color = "white")+
scale_fill_gradient(low = "#f7fcf0",
high = "#084081",
na.value = "grey",
breaks = c(0,100,150,200,250,300,400),
labels = c(0,100,150,200,250,300,400))+
theme_void()+
labs(fill = "Servings",
title = "Figure3: Beer global alcohol consumption",
caption = "NA value: grey;
Servings: beer servings")
ggplot(map_data, aes(x = long, y = lat, group = group,
text = sprintf("region: %s<br>beer servings: %s",
region, beer_servings)))+
geom_polygon( aes(fill = beer_servings), color = "white")+
scale_fill_gradient(low = "#f7fcf0",
high = "#084081",
na.value = "grey",
breaks = c(0,100,150,200,250,300,350,400),
labels = c(0,100,150,200,250,300,350,400))+
theme_void()+
labs(fill = "Servings",
title = "Figure3: Beer global alcohol consumption",
caption = "NA value: grey;
Servings: beer servings")
ggplot(map_data, aes(x = long, y = lat, group = group,
text = sprintf("region: %s<br>beer servings: %s",
region, beer_servings)))+
geom_polygon( aes(fill = beer_servings), color = "white")+
scale_fill_gradient(low = "#fff7f3",
high = "#49006a",
na.value = "grey",
breaks = c(0,100,150,200,250,300,350,400),
labels = c(0,100,150,200,250,300,350,400))+
theme_void()+
labs(fill = "Servings",
title = "Figure3: Beer global alcohol consumption",
caption = "NA value: grey;
Servings: beer servings")
ggplotly(p1, tooltip = "text")
p2<-ggplot(map_data, aes(x = long, y = lat, group = group,
text = sprintf("region: %s<br>beer servings: %s",
region, beer_servings)))+
geom_polygon( aes(fill = beer_servings), color = "white")+
scale_fill_gradient(low = "#fff7f3",
high = "#49006a",
na.value = "grey",
breaks = c(0,100,150,200,250,300,350,400),
labels = c(0,100,150,200,250,300,350,400))+
theme_void()+
labs(fill = "Servings",
title = "Figure3: Beer global alcohol consumption",
caption = "NA value: grey;
Servings: beer servings")
ggplotly(p2, tooltip = "text")
p3<- ggplot(map_data, aes(x = long, y = lat, group = group,
text = sprintf("region: %s<br>spirit servings: %s",
region, spirit_servings)))+
geom_polygon( aes(fill = spirit_servings), color = "white")+
scale_fill_gradient(low = "#fff7f3",
high = "#49006a",
na.value = "grey",
breaks = c(0,50,100,150,200,250,300,350,400),
labels = c(0,50,100,150,200,250,300,350,400))+
theme_void()+
labs(fill = "Servings",
title = "Figure4: Beer global alcohol consumption",
caption = "NA value: grey;
Servings: spirit servings")
ggplotly(p2, tooltip = "text")
p3<- ggplot(map_data, aes(x = long, y = lat, group = group,
text = sprintf("region: %s<br>spirit servings: %s",
region, spirit_servings)))+
geom_polygon( aes(fill = spirit_servings), color = "white")+
scale_fill_gradient(low = "#fff7f3",
high = "#49006a",
na.value = "grey"
# breaks = c(0,50,100,150,200,250,300,350,400),
# labels = c(0,50,100,150,200,250,300,350,400)
)+
theme_void()+
labs(fill = "Servings",
title = "Figure4: Spirit global alcohol consumption",
caption = "NA value: grey;
Servings: spirit servings")
ggplotly(p2, tooltip = "text")
ggplotly(p3, tooltip = "text")
ggplot(map_data, aes(x = long, y = lat, group = group,
text = sprintf("region: %s<br>wine servings: %s",
region, wine_servings)))+
p4<-  geom_polygon( aes(fill = wine_servings), color = "white")+
scale_fill_gradient(low = "#fff7f3",
high = "#49006a",
na.value = "grey")+
theme_void()+
labs(fill = "Servings",
title = "Figure4: Beer global alcohol consumption",
caption = "NA value: grey;
Servings: wine servings")
ggplot(map_data, aes(x = long, y = lat, group = group,
text = sprintf("region: %s<br>wine servings: %s",
region, wine_servings)))+
p4<-  geom_polygon( aes(fill = wine_servings), color = "white")+
scale_fill_gradient(low = "#fff7f3",
high = "#49006a",
na.value = "grey")+
theme_void()+
labs(fill = "Servings",
title = "Figure5: Wine global alcohol consumption",
caption = "NA value: grey;
Servings: wine servings")
p4 <- ggplot(map_data, aes(x = long, y = lat, group = group,
text = sprintf("region: %s<br>wine servings: %s",
region, wine_servings)))+
geom_polygon( aes(fill = wine_servings), color = "white")+
scale_fill_gradient(low = "#fff7f3",
high = "#49006a",
na.value = "grey")+
theme_void()+
labs(fill = "Servings",
title = "Figure5: Wine global alcohol consumption",
caption = "NA value: grey;
Servings: wine servings")
ggplotly(p4, tooltip = "text")
p1<- ggplot(map_data, aes(x = long, y = lat, group = group,
text = sprintf("region: %s<br>total litres of pure alcohol: %s",
region, total_litres_of_pure_alcohol)))+
geom_polygon( aes(fill = total_litres_of_pure_alcohol), color = "white")+
scale_fill_gradient(low = "#e0ecf4",
high = "#4d004b",
na.value = "grey",
breaks = c(0,2,4,6,8,10,12,14),
labels = c(0,2,4,6,8,10,12,14))+
theme_void()+
labs(fill = "Litres",
title = "Figure1: Global alcohol consumption")+
theme_classic()
ggplotly(p1, tooltip = "text")
p1<- ggplot(map_data, aes(x = long, y = lat, group = group,
text = sprintf("region: %s<br>total litres of pure alcohol: %s",
region, total_litres_of_pure_alcohol)))+
geom_polygon( aes(fill = total_litres_of_pure_alcohol), color = "white")+
scale_fill_gradient(low = "#e0ecf4",
high = "#4d004b",
na.value = "grey",
breaks = c(0,2,4,6,8,10,12,14),
labels = c(0,2,4,6,8,10,12,14))+
theme_classic()+
theme_void()+
labs(fill = "Litres",
title = "Figure1: Global alcohol consumption")
ggplotly(p1, tooltip = "text")
p1<- ggplot(map_data, aes(x = long, y = lat, group = group,
text = sprintf("region: %s<br>total litres of pure alcohol: %s",
region, total_litres_of_pure_alcohol)))+
geom_polygon( aes(fill = total_litres_of_pure_alcohol), color = "white")+
scale_fill_gradient(low = "#e0ecf4",
high = "#4d004b",
na.value = "grey",
breaks = c(0,2,4,6,8,10,12,14),
labels = c(0,2,4,6,8,10,12,14))+
theme_void()+
theme(panel.grid = element_blank())+
labs(fill = "Litres",
title = "Figure1: Global alcohol consumption")
ggplotly(p1, tooltip = "text")
p2<-ggplot(map_data, aes(x = long, y = lat, group = group,
text = sprintf("region: %s<br>beer servings: %s",
region, beer_servings)))+
geom_polygon( aes(fill = beer_servings), color = "white")+
scale_fill_gradient(low = "#fff7f3",
high = "#49006a",
na.value = "grey",
breaks = c(0,50,100,150,200,250,300,350,400),
labels = c(0,50,100,150,200,250,300,350,400))+
theme_void()+
theme(panel.grid = element_blank(),
axis.ticks = element_blank())+
labs(fill = "Servings",
title = "Figure3: Beer global alcohol consumption",
caption = "NA value: grey;
Servings: beer servings")
ggplotly(p2, tooltip = "text")
p2<-ggplot(map_data, aes(x = long, y = lat, group = group,
text = sprintf("region: %s<br>beer servings: %s",
region, beer_servings)))+
geom_polygon( aes(fill = beer_servings), color = "white")+
scale_fill_gradient(low = "#fff7f3",
high = "#49006a",
na.value = "grey",
breaks = c(0,50,100,150,200,250,300,350,400),
labels = c(0,50,100,150,200,250,300,350,400))+
theme_void()+
theme(panel.grid = element_blank())+
labs(fill = "Servings",
title = "Figure3: Beer global alcohol consumption",
xlab = "NULL",
ylab = "NULL")
ggplotly(p2, tooltip = "text")
p2<-ggplot(map_data, aes(x = long, y = lat, group = group,
text = sprintf("region: %s<br>beer servings: %s",
region, beer_servings)))+
geom_polygon( aes(fill = beer_servings), color = "white")+
scale_fill_gradient(low = "#fff7f3",
high = "#49006a",
na.value = "grey",
breaks = c(0,50,100,150,200,250,300,350,400),
labels = c(0,50,100,150,200,250,300,350,400))+
theme_void()+
theme(panel.grid = element_blank(),
axis.line.x = element_blank())+
labs(fill = "Servings",
title = "Figure3: Beer global alcohol consumption")
ggplotly(p2, tooltip = "text")
p2<-ggplot(map_data, aes(x = long, y = lat, group = group,
text = sprintf("region: %s<br>beer servings: %s",
region, beer_servings)))+
geom_polygon( aes(fill = beer_servings), color = "white")+
scale_fill_gradient(low = "#fff7f3",
high = "#49006a",
na.value = "grey",
breaks = c(0,50,100,150,200,250,300,350,400),
labels = c(0,50,100,150,200,250,300,350,400))+
theme_void()+
theme(panel.grid = element_blank(),
axis.line.x = element_blank(),
axis.line.y = element_blank())+
labs(fill = "Servings",
title = "Figure3: Beer global alcohol consumption")
ggplotly(p2, tooltip = "text")
relationship %>%
group_by(Alcohol_servings) %>%
ggplot( aes(x = servings, y = ..density..))+
geom_density( aes(color = Alcohol_servings, fill = Alcohol_servings), alpha = 0.25, size = 0.75)+
ggtitle("Figure2: Density of alcohol servings")+
#scale_y_sqrt()+
theme_bw()+
guides(fill = guide_legend(title = "Alcohol servings"),
color = guide_legend(title = "Alcohol servings"))
relationship %>%
group_by(Alcohol_servings) %>%
ggplot( aes(x = servings, y = ..density..))+
geom_density( aes(color = Alcohol_servings, fill = Alcohol_servings), alpha = 0.25, size = 0.75)+
ggtitle("Figure2: Density of alcohol servings")+
scale_y_sqrt()+
theme_bw()+
guides(fill = guide_legend(title = "Alcohol servings"),
color = guide_legend(title = "Alcohol servings"))
p1<- ggplot(map_data, aes(x = long, y = lat, group = group,
text = sprintf("region: %s<br>total litres of pure alcohol: %s",
region, total_litres_of_pure_alcohol)))+
geom_polygon( aes(fill = total_litres_of_pure_alcohol), color = "white")+
scale_fill_gradient(low = "#ffffcc",
high = "#800026",
na.value = "grey",
breaks = c(0,2,4,6,8,10,12,14),
labels = c(0,2,4,6,8,10,12,14))+
theme_void()+
theme(panel.grid = element_blank(),
axis.line.x = element_blank(),
axis.line.y = element_blank())+
labs(fill = "Litres",
title = "Figure1: Global alcohol consumption")
ggplotly(p1, tooltip = "text")
p1<- ggplot(map_data, aes(x = long, y = lat, group = group,
text = sprintf("region: %s<br>total litres of pure alcohol: %s",
region, total_litres_of_pure_alcohol)))+
geom_polygon( aes(fill = total_litres_of_pure_alcohol), color = "white")+
scale_fill_gradient(low = "#ffffd9",
high = "#081d58",
na.value = "grey",
breaks = c(0,2,4,6,8,10,12,14),
labels = c(0,2,4,6,8,10,12,14))+
theme_void()+
theme(panel.grid = element_blank(),
axis.line.x = element_blank(),
axis.line.y = element_blank())+
labs(fill = "Litres",
title = "Figure1: Global alcohol consumption")
ggplotly(p1, tooltip = "text")
p1<- ggplot(map_data, aes(x = long, y = lat, group = group,
text = sprintf("region: %s<br>total litres of pure alcohol: %s",
region, total_litres_of_pure_alcohol)))+
geom_polygon( aes(fill = total_litres_of_pure_alcohol), color = "white")+
scale_fill_gradient(low = "#f7fcfd",
high = "#00441b",
na.value = "grey",
breaks = c(0,2,4,6,8,10,12,14),
labels = c(0,2,4,6,8,10,12,14))+
theme_void()+
theme(panel.grid = element_blank(),
axis.line.x = element_blank(),
axis.line.y = element_blank())+
labs(fill = "Litres",
title = "Figure1: Global alcohol consumption")
ggplotly(p1, tooltip = "text")
p1<- ggplot(map_data, aes(x = long, y = lat, group = group,
text = sprintf("region: %s<br>total litres of pure alcohol: %s",
region, total_litres_of_pure_alcohol)))+
geom_polygon( aes(fill = total_litres_of_pure_alcohol), color = "white")+
scale_fill_gradient(low = "#fff7ec",
high = "#7f0000",
na.value = "grey",
breaks = c(0,2,4,6,8,10,12,14),
labels = c(0,2,4,6,8,10,12,14))+
theme_void()+
theme(panel.grid = element_blank(),
axis.line.x = element_blank(),
axis.line.y = element_blank())+
labs(fill = "Litres",
title = "Figure1: Global alcohol consumption")
ggplotly(p1, tooltip = "text")
alcohol <- read_csv(here::here("posts/Alcohol Shiny App/week13_alcohol_global.csv"))
library(shiny)
library(tidyverse)
alcohol <- read_csv(here::here("posts/Alcohol Shiny App/week13_alcohol_global.csv"))
library(plotly)
library(gghighlight)
stations <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2022/2022-03-01/stations.csv')
View(stations)
library(readxl)
library(kableExtra)
library(knitr)
library(tidyverse)
library(naniar)
library(lubridate)
library(bookdown)
library(gridExtra)
library(Hmisc)
stations <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2022/2022-03-01/stations.csv')
elec <- stations %>%
filter(FUEL_TYPE_CODE == 'ELEC')  #filter the fuel type == electric
elec_stations <- elec %>%
filter(!is.na(OPEN_DATE)) %>%     #filter open date == NA, set new columns: the month of open date, the year of open date
mutate(month = month(OPEN_DATE),
year = year(OPEN_DATE)) %>%
filter(year < 2022)
View(elec_stations)
View(elec_stations)
?leaflet
library(leaflet)
leaflet(data = elec_stations) %>%
addTiles() %>%
addMarkers(lng = ~LONGITUDE, lat = ~LATITUDE, popup = elec_stations$STATION_NAME,
clusterOptions = markerClusterOptions())
LEVEL1 <-  impute(elec_stations$EV_LEVEL1_EVSE_NUM, 0)
LEVEL2 <-  impute(elec_stations$EV_LEVEL2_EVSE_NUM, 0)  # replace NA to 0
OTHER <-  impute(elec_stations$EV_OTHER_INFO, 0)
port_num <- elec_stations %>%
mutate(LEVEL1_NUM = LEVEL1 ,
LEVEL2_NUM = LEVEL2,
OTHER_NUM = OTHER) %>%
mutate(PORT_NUM = LEVEL1_NUM + LEVEL2_NUM+ OTHER_NUM)
View(port_num)
leaflet(data = port_num) %>%
addTiles() %>%
addMarkers(lng = ~LONGITUDE, lat = ~LATITUDE,
popup = paste(port_num$STATION_NAME,' port num:', port_num$PORT_NUM),
clusterOptions = markerClusterOptions())
leaflet(data = port_num) %>%
addTiles() %>%
addMarkers(lng = ~LONGITUDE, lat = ~LATITUDE,
popup = sprintf("station name: %s<br> port num: %s",
port_num$STATION_NAME, port_num$PORT_NUM),
clusterOptions = markerClusterOptions())
#| fig-cap: "Figure1: The trend of ports number and elec stations number"
#| fig-width: 9
#| fig-height: 5
#| fig-align: "center"
elec <- stations %>%
filter(FUEL_TYPE_CODE == 'ELEC')  #filter the fuel type == electric
elec_stations <- elec %>%
filter(!is.na(OPEN_DATE)) %>%     #filter open date == NA, set new columns: the month of open date, the year of open date
mutate(month = month(OPEN_DATE),
year = year(OPEN_DATE)) %>%
filter(year < 2022)
year_trend <- elec_stations %>%      #the trend of electric stations over year except 2022
group_by(year) %>%
summarise(num = n())
LEVEL1 <-  impute(elec_stations$EV_LEVEL1_EVSE_NUM, 0)
LEVEL2 <-  impute(elec_stations$EV_LEVEL2_EVSE_NUM, 0)  # replace NA to 0
OTHER <-  impute(elec_stations$EV_OTHER_INFO, 0)
port_num <- elec_stations %>%
mutate(LEVEL1_NUM = LEVEL1 ,
LEVEL2_NUM = LEVEL2,
OTHER_NUM = OTHER) %>%
mutate(PORT_NUM = LEVEL1_NUM + LEVEL2_NUM+ OTHER_NUM)
#The trend of ports number and elec stations number
yr_port_num <- port_num %>%
group_by(year) %>%
summarise(num = sum(PORT_NUM))
p3 <- ggplot()+
geom_line(data = yr_port_num,
aes(x = year, y = num, color = "ports"), size = 0.75)+
geom_line(data = year_trend,
aes(x = year, y = num, color = "elec stations"), size = 0.75)+
scale_x_continuous(breaks = seq(1995,2021,1))+
scale_y_log10()+
ggtitle("The trend of ports number and elec stations number")+
theme_bw()+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
p3
p3 <- ggplot()+
geom_line(data = yr_port_num,
aes(x = year, y = num, color = "ports"), size = 0.75)+
geom_line(data = year_trend,
aes(x = year, y = num, color = "elec stations"), size = 0.75)+
scale_x_continuous(breaks = seq(1995,2021,1))+
# scale_y_log10()+
ggtitle("The trend of ports number and elec stations number")+
theme_bw()+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
p3
p3 <- ggplot()+
geom_line(data = yr_port_num,
aes(x = year, y = num, color = "ports"), size = 0.75)+
geom_line(data = year_trend,
aes(x = year, y = num, color = "elec stations"), size = 0.75)+
scale_x_continuous(breaks = seq(1995,2021,1))+
scale_y_log10()+
ggtitle("The trend of ports number and elec stations number")+
theme_bw()+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
p3
?leaflet
??leaflet
