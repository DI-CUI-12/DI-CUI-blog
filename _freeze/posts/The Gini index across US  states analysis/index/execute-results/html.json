{
  "hash": "375f4c432797e665d22283c6ad7e038a",
  "result": {
    "markdown": "---\ntitle: \"The Gini index across US states analysis\"\nexecute: \n  warning: false\n  message: false\n  error: false\nauthor: \"Di Cui\"\ndate: \"2023-09-01\"\ncategories: [High Dimensional Data Analysis]\nimage: \"gini.PNG\"\nformat: \n  html:\n    toc: true\n    code-fold: true\n    css: gini.css\neditor_options: \n  chunk_output_type: console\n---\n\n\n\n\n\n\n# Introduction \n\nThe Gini coefficient offers a quantitative lens to assess income inequality, a pressing societal concern. It scales from zero, representing complete equality, to one, denoting extreme inequality, thus encapsulating the economic disparities within a society (Adam, 2023).\n\nThis report delves into the variations in the Gini index across US states. At its core, we're interested in examining how pivotal events such as the Great Depression, World War II, and the Global Financial Crisis influenced state-level income disparities.\n\nTo ensure rigorous insights, we begin with detailed data preparation and cleansing. This foundational step paves the way for insightful data visualizations, highlighting intrinsic trends and anomalies.\n\nWe employ Principal Component Analysis (PCA) and Multidimensional Scaling (MDS) as our primary analytical tools, recognized for their prowess in reducing  multidimenstional data. The report will also touch upon the potential constraints and issues faced throughout our investigation.\"\n\n\n\n\n\n# Data description and wrangling \n\n## Datasets Overview\n\nThe primary dataset for this analysis has been procured from the repository titled \"U.S. State-Level Income Inequality Data\", diligently compiled by Mark W. Frank.\nThe data repository furnished two distinct datasets for the periods:\n1929 to 1945: Capturing the Gini index values across 50 U.S. states.\n2007 to 2015: This dataset details the Gini index values for an expanded list of 52 U.S. states, reflecting the statehood transitions post-1959, Alaska and Hawaii became states. \nGiven the absence of data from 1946 to 2006, and the changes in statehood, it was decided not to merge the two datasets.\n\n\n## Data Cleaning and Imputation:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nInequality_GD <- read_csv(\"Inequality_GD.csv\") %>% \n            select(-c(\"...1\"))\nInequality_GR <- read_csv(\"Inequality_GR.csv\")%>% \n             select(-c(\"...1\"))\n```\n:::\n\n\n\n### KNN imputation for missing value \n\nThe dataset from 2007 to 2015 exhibited missing values for some states in 2010, accounting for approximately 1.5% @fig-vismiss of the entire dataset. To address this, we applied KNN imputation, which takes into account inter-variable relationships. This method not only preserves a more natural variability in imputed values but also offers a more sophisticated approach than mere column-wise mean imputation. \n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nInequality_GR %>% vis_miss(warn_large_data = FALSE)\n```\n\n::: {.cell-output-display}\n![Percentage of missing value between 2007 and 2015](index_files/figure-html/fig-vismiss-1.png){#fig-vismiss fig-align='center' width=120%}\n:::\n:::\n\n\n\n### Mean imputation for outlier \n\nFrom the @fig-outlier, an evident outlier was identified in the 1929 to 1945 dataset: Oregon's Gini index recorded as 1000 in 1934. Considering the Gini index's range is between 0 and 1, this is a data entry error. We employed mean imputation to address this, calculating the average from the years immediately preceding and following 1934 for Oregon.\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nInequality_GD_long <- Inequality_GD %>%\n  pivot_longer(cols = `1929`:`1945`, \n               names_to = \"year\", \n               values_to = \"gini index\")\n\n\nInequality_GR_long <- Inequality_GR %>%\n  pivot_longer(cols = `2007`:`2015`, \n               names_to = \"year\", \n               values_to = \"gini index\")\n\nggplot(Inequality_GD, aes(x = State, y = `1934`)) + \n    geom_point() +\n    theme(axis.text.x = element_text(angle = 45, hjust = 1)) +\n    ggtitle(\"Gini Index for US States in 1934\")\n```\n\n::: {.cell-output-display}\n![The outlier of Gini index in 1934](index_files/figure-html/fig-outlier-1.png){#fig-outlier fig-align='center' width=120%}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n##KNN imputation \nstate_col <- Inequality_GR$State\n\n# Remove 'State' column for imputation\nGR_for_imputation <- Inequality_GR[, -which(names(Inequality_GR) == \"State\")]\n\nmin_max_scale <- function(x) {\n    (x - min(x, na.rm = TRUE)) / (max(x, na.rm = TRUE) - min(x, na.rm = TRUE))\n}\n\nGR_normalized <- as.data.frame(lapply(GR_for_imputation, min_max_scale))\n\nGR_imputed <- knnImputation(GR_normalized, k = 5)\n\n\noriginal_mins <- apply(GR_for_imputation, 2, min, na.rm = TRUE)\noriginal_maxs <- apply(GR_for_imputation, 2, max, na.rm = TRUE)\n\nGR_rescaled <- as.data.frame(mapply(function(col, min_val, max_val) {\n    col * (max_val - min_val) + min_val\n}, GR_imputed, original_mins, original_maxs, SIMPLIFY=FALSE))\n\nnames(GR_rescaled) <- names(GR_for_imputation)\n\nGR_rescaled$State <- state_col\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\noregon_1933 <- Inequality_GD[Inequality_GD$State == \"Oregon\", \"1933\"]\noregon_1935 <- Inequality_GD[Inequality_GD$State == \"Oregon\", \"1935\"]\n\n# Replace the 1934 value with the average of 1933 and 1935 for Oregon\nInequality_GD[Inequality_GD$State == \"Oregon\", \"1934\"] <- \n  (oregon_1933 + oregon_1935) / 2 \n\nGD_new <-Inequality_GD\n```\n:::\n\n\n## Other data credibility issues\n\nWe ensured data consistency and corrected spatial discrepancies for accurate results.\nFor better visualization, adding column to provides state abbreviations, like \"Los Angeles\" as \"LA\".\n\n\n\n\n\n# Exploratory analysis and visulaization \n\nFrom the @fig-boxplot-pre, between 1929 and 1945, the Gini index dropped from 0.49 to 0.40 during the early Great Depression, a result of significant stock market losses that reduced the wealth gap between the upper and middle class (Goldin & Margo, 1992). The index fluctuated between 0.39 and 0.45 throughout the later Depression years and World War II, with the spread narrowing over time. This reduction in inequality can be attributed to progressive tax policies implemented to fund the war, which disproportionately taxed the wealthy (Piketty & Saez, 2003).\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nGD_new_long <- GD_new %>% \n  pivot_longer(cols = `1929`:`1945`, \n               names_to = \"year\", \n               values_to = \"gini index\")\n\nGD_summary <- GD_new_long %>% \n  group_by(year) %>%\n  summarise(`mean of Gini index`= round(mean(`gini index`),5) )%>% \n  rename(\"Year\" = \"year\",\n         \"Mean of Gini index\"= \"mean of Gini index\")\n\n#summary table\n\nDT::datatable(GD_summary,options = list(pageLength = 4,\n                                        searching = FALSE))\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-4ee967bf4626ad5e7be2\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-4ee967bf4626ad5e7be2\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\"],[\"1929\",\"1930\",\"1931\",\"1932\",\"1933\",\"1934\",\"1935\",\"1936\",\"1937\",\"1938\",\"1939\",\"1940\",\"1941\",\"1942\",\"1943\",\"1944\",\"1945\"],[0.49401,0.45153,0.43181,0.40839,0.41791,0.4229,0.42548,0.45266,0.43531,0.44783,0.42877,0.39173,0.40323,0.42046,0.38541,0.4138,0.44219]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>Year<\\/th>\\n      <th>Mean of Gini index<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"pageLength\":4,\"searching\":false,\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":2},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false,\"lengthMenu\":[4,10,25,50,100]}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nGD_new_long$period <- case_when(GD_new_long$year < 1939 ~ \"Great Depression\", \n                                GD_new_long$year >= 1939 & GD_new_long$year < 1942 ~\"Great Depression&World War II\", \n                                TRUE~ \"World War II\")\n\n#Colored Boxplot \nggplot(GD_new_long, aes(x = year, y = `gini index`, fill = period)) +\n  geom_boxplot() +\n  scale_fill_manual(values = c(\"Great Depression\" = \"blue\", \"Great Depression&World War II\" = \"green\", \"World War II\" = \"red\")) +\n  labs(fill = \"Period\",\n       title = \"Distribution of Gini index between 1929 and 1945\") +\n  theme_minimal()+\n  theme(axis.text.x = element_text(angle = 30, hjust = 1))\n```\n\n::: {.cell-output-display}\n![Distribution of Gini index between 1929 and 1945](index_files/figure-html/fig-boxplot-pre-1.png){#fig-boxplot-pre fig-align='center' width=120%}\n:::\n:::\n\n\nContrastingly, from 2007 to 2015,from the @fig-boxplot2 the Gini index surged by over 40%, averaging around 0.6. This rise is linked to the Global Financial Crisis (GFC) causing major job losses, especially in the construction and finance sectors, and affecting primarily the middle and lower-income households. Post-GFC, the index slightly decreased in 2009 and 2010 but stabilized around 0.6 thereafter, with noticeable outliers appearing between 2012 and 2015.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nGR_rescale_long <- GR_rescaled %>% \n  pivot_longer(cols = `2007`:`2015`, \n               names_to = \"year\", \n               values_to = \"gini index\")\n\n\nGR_summary <- GR_rescale_long %>% \n  group_by(year) %>%\n  summarise(`mean of Gini index`= round(mean(`gini index`),5) )%>% \n  rename(\"Year\" = \"year\",\n         \"Mean of Gini index\" = \"mean of Gini index\") \n\n#summary table\n  \nDT::datatable(GR_summary,options = list(pageLength = 4,\n                                        searching = FALSE))\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-bb57e83c3b5bfd9c988e\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-bb57e83c3b5bfd9c988e\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\"],[\"2007\",\"2008\",\"2009\",\"2010\",\"2011\",\"2012\",\"2013\",\"2014\",\"2015\"],[0.61513,0.61201,0.60512,0.60066,0.60432,0.61805,0.60507,0.60971,0.60915]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>Year<\\/th>\\n      <th>Mean of Gini index<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"pageLength\":4,\"searching\":false,\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":2},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false,\"lengthMenu\":[4,10,25,50,100]}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n#Colored boxplot\nGR_rescale_long$period <- ifelse(GR_rescale_long$year < 2009, \"Global Financial Crisis\", \"After Financial Crisis\")\n\n# Boxplot\nggplot(GR_rescale_long, aes(x = year, y = `gini index`, fill = period)) +\n  geom_boxplot() +\n  scale_fill_manual(values = c(\"After Financial Crisis\" = \"blue\", \"Global Financial Crisis\" = \"red\")) +\n  labs(fill = \"Period\",\n       title = \"Distribution of Gini index between 2007 and 2015\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![Distribution of Gini index between 2007 and 2015](index_files/figure-html/fig-boxplot2-1.png){#fig-boxplot2 fig-align='center' width=120%}\n:::\n:::\n\n\n\n\n\n\n\n# Assupmtion and methodology \n\nWe only consider metric variables and employ Euclidean distance, eliminating the need for standardization due to the consistent unit of measurement. This section delves into the foundations of Principal Component Analysis (PCA) and Multidimensional Scaling (MDS).\n\nPCA reduces data dimensions while retaining the utmost information, aiming to maximize variance explanation in the process. The associated assumptions include:\n- Linearity: Variables possess a linear relationship.\n- Orthogonality: Principal components are mutually uncorrelated.\n- Homoscedasticity: A consistent variance across all data points.\n- Independence: Variables operate independently.\n\nMDS visualizes data point similarities in a reduced dimensional space, with the following assumptions:\n- Metric: Data points distances are metric.\n- Data Similarity: The measures used effectively depict data relationships.\n- Continuity: Data reveals a continuous structure.\n- Linearity: A linear interrelation exists among variables.\"\n\n\n#  Multidimensional Scaling (MDS) Analysis\n\nIn this section, we employ Multidimensional Scaling (MDS) to analyze two datasets, each containing approximately 15 variables. MDS offers an optimal representation of data in a low-dimensional space, aiding visualization of sample similarities/dissimilarities. By observing plots generated from datasets linked to specific events, we can discern the impact of these events on the data.\n\n## Classic mds\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nGD_sf <- left_join(GD_new,GD_states_sf,by = c(\"State\" = \"NAME\")) %>%\n  select(-State) %>%\n  rename(\"State\" = \"abb\")\n\nGD_sf$State[is.na(GD_sf$State)] <- \"US\"\n\n\nGR_sf <- left_join(GR_rescaled,GR_states_sf,by = c(\"State\" = \"NAME\")) %>%\n  select(-State) %>%\n  rename(\"State\" = \"abb\")\n\nGR_sf$State[is.na(GR_sf$State)] <- \"US\"\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmds <- GD_new %>%\n  select(-1) %>% \n  dist() %>%          \n  cmdscale() %>%\n  as_tibble() \n\ncolnames(mds) <- c(\"Dim.1\", \"Dim.2\")\n\n# K-means clustering\nclust <- kmeans(mds, 4)$cluster %>%\n  as.factor()\nmds <- mds %>%\n  mutate(groups = clust,\n         state = GD_sf$State)\n# Plot and color by groups\nggscatter(mds, x = \"Dim.1\", y = \"Dim.2\", \n          label = \"state\",\n          color = \"groups\",\n          palette = \"jco\",\n          size = 1, \n          ellipse = TRUE,\n          ellipse.type = \"convex\",\n          repel = TRUE) +\n  ggtitle(\"Classical MDS 1929-1945\") -> mds1\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmds <- GR_rescaled %>%\n  select(-State) %>% \n  dist() %>%          \n  cmdscale() %>%\n  as_tibble() \n\ncolnames(mds) <- c(\"Dim.1\", \"Dim.2\")\n\n# K-means clustering\nclust <- kmeans(mds, 4)$cluster %>%\n  as.factor()\nmds <- mds %>%\n  mutate(groups = clust,\n         state = GR_sf$State)\n# Plot and color by groups\nggscatter(mds, x = \"Dim.1\", y = \"Dim.2\", \n          label = \"state\",\n          color = \"groups\",\n          palette = \"jco\",\n          size = 1, \n          ellipse = TRUE,\n          ellipse.type = \"convex\",\n          repel = TRUE)+\n  ggtitle(\"Classical MDS 2007-2015\") -> mds2\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmds1 + mds2\n```\n\n::: {.cell-output-display}\n![MDS analysis Plot](index_files/figure-html/fig-mds-p1-1.png){#fig-mds-p1 fig-align='center' width=120%}\n:::\n:::\n\n\nFrom the @fig-mds-p1, similarities and dissimilarities are evident based on distances between data points. For instance, in the \"Classical MDS 1929-1945\" plot, Delaware appears as a potential outlier. Yet, in the \"Classical MDS 2007-2015\", Delaware clusters with states like West Virginia and Washington, while California and others emerge as outliers.\n\n## Sammon Mapping\n\nWe use another type of MDS that is called sammon mapping to see whether our\nconclusion still holds. Sammon mapping is not based on eigenvalue decomposition and linear mapping so that it preserves the local structure.\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# GD 2007-2015\nsam <- GR_rescaled %>%\n  select(-1) %>% \n  dist() %>%          \n  sammon()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nInitial stress        : 0.00145\nstress after  10 iters: 0.00096, magic = 0.500\nstress after  20 iters: 0.00096, magic = 0.500\n```\n:::\n\n```{.r .cell-code}\nsam$points %>% \n  as_tibble() -> sam\n\ncolnames(sam) <- c(\"Sam.1\", \"Sam.2\")\n\n# K-means clustering\nclust <- kmeans(sam, 4)$cluster %>%\n  as.factor()\n\nsam <- sam %>%\n  mutate(groups = clust,\n         state = GR_sf$State)\n# plot\nggscatter(sam, x = \"Sam.1\", y = \"Sam.2\", \n          label = \"state\",\n          color = \"groups\",\n          palette = \"jco\",\n          size = 1, \n          ellipse = TRUE,\n          ellipse.type = \"convex\",\n          repel = TRUE)+\n  ggtitle(\"SAM 2007-2015\") -> Sam2\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nSam1 + Sam2\n```\n\n::: {.cell-output-display}\n![Sammon mapping analysis Plot](index_files/figure-html/fig-mds-p2-1.png){#fig-mds-p2 fig-align='center' width=120%}\n:::\n:::\n\n\nAs you can see from the @fig-mds-p2, it has a similar pattern to classic MDS, but some states, such as North Dakota and New Mexico will be further away (not similar).\n\n\n\n\n# Principal Component Analysis (PCA) \n\n## Great Depression and World War II\n\n### Importance of PCs(pricipal components)\n\nFrom our analysis, PC1 accounts for 75.8% of the total variance, while PC2 contributes an additional 15.28%. Together, PC1 and PC2 capture 91.08% of the data's overall variance. This high cumulative proportion suggests that these two components predominantly encapsulate the dataset's information, validating our choice for dimensionality reduction.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n#########PCA ######\nGD_pca<- GD_sf %>% \n  column_to_rownames('State') %>% \n  prcomp(scale. = TRUE)\n\n summary(GD_pca)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nImportance of components:\n                         PC1    PC2     PC3     PC4     PC5     PC6     PC7\nStandard deviation     3.590 1.6116 0.78748 0.57044 0.35623 0.34949 0.29707\nProportion of Variance 0.758 0.1528 0.03648 0.01914 0.00746 0.00718 0.00519\nCumulative Proportion  0.758 0.9108 0.94730 0.96644 0.97391 0.98109 0.98628\n                           PC8     PC9    PC10    PC11    PC12    PC13    PC14\nStandard deviation     0.24100 0.21648 0.20062 0.17286 0.12792 0.12232 0.11231\nProportion of Variance 0.00342 0.00276 0.00237 0.00176 0.00096 0.00088 0.00074\nCumulative Proportion  0.98970 0.99246 0.99483 0.99658 0.99755 0.99843 0.99917\n                          PC15    PC16      PC17\nStandard deviation     0.08716 0.08092 2.665e-07\nProportion of Variance 0.00045 0.00039 0.000e+00\nCumulative Proportion  0.99961 1.00000 1.000e+00\n```\n:::\n:::\n\n### Screenplot\n\nThe @fig-screeplot-gd further confirms this decision, identifying PC2 as an elbow point. \n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nscreeplot(GD_pca, type = \"l\")\n```\n\n::: {.cell-output-display}\n![ Screeplot for PCs 1929-1945](index_files/figure-html/fig-screeplot-gd-1.png){#fig-screeplot-gd fig-align='center' width=120%}\n:::\n:::\n\n### Correlation between Gini index and PCs\n\nUpon analyzing the correlation between the Gini index and the principal components, we observe that a consistently negative and weak correlation with PC1 but have a tendency to become stronger. This meaning the pattern represented by PC1 is becoming more inversely related to the Gini index over time. A variable relationship with PC2: negative for 1929-1938 but turns positive for 1939-1945. Notably, 1942 and 1945 showcase a strong positive correlation, whereas 1937-1939 indicates weak or negligible correlation.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Extract loadings\nloadings <- GD_pca$rotation[, 1:2]  # considering only PC1 and PC2\n\n\ntransposed_loadings <- t(loadings)\ntransposed_df1 <- as.data.frame(transposed_loadings [,1:9])\nrownames(transposed_df1) <- c(\"PC1\", \"PC2\")\ncolnames(transposed_df1) <- 1929:1937\n\ntransposed_loadings <- t(loadings)\ntransposed_df2 <- as.data.frame(transposed_loadings [,10:17])\nrownames(transposed_df2) <- c(\"PC1\", \"PC2\")\ncolnames(transposed_df2) <- 1938:1945\n\n\ntransposed_df1\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n          1929       1930       1931       1932       1933       1934\nPC1 -0.2349858 -0.2459327 -0.2571730 -0.2603796 -0.2616853 -0.2680236\nPC2 -0.2691690 -0.2588394 -0.1902042 -0.1824073 -0.1750844 -0.1299880\n          1935       1936        1937\nPC1 -0.2673863 -0.2687829 -0.27104249\nPC2 -0.1491159 -0.1243959 -0.08455504\n```\n:::\n\n```{.r .cell-code}\ntransposed_df2\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n           1938        1939       1940       1941       1942       1943\nPC1 -0.25702053 -0.26145875 -0.2445857 -0.2290794 -0.1856574 -0.1878753\nPC2 -0.01160135  0.02923975  0.1828159  0.2239589  0.3761331  0.3952901\n          1944       1945\nPC1 -0.1964641 -0.1943193\nPC2  0.4043742  0.3909881\n```\n:::\n:::\n\n\n### Correlation biplot\n\nThe correlation @fig-gd-biplot reveals that all years negatively align with PC1. Besides, Early years exhibit negative correlations with PC2, mid-years are vertical, and later years are positive.\nIn essence, PC1 primarily reflects inequality during the early World War II years. Greater inequality during this period corresponds to higher PC1 values.\nAnd PC2 embodies inequality nuances from both the Great Depression era and the mid to late World War II years.\n\nExamining the data further, states such as CT(Connecticut), PA(Pennsylvania), and MA(Massachusetts) exhibit pronounced inequality during the Great Depression (1929-1933), impacting their overall inequality significantly. Conversely, DE(Delaware) displayed the most significant inequality during World War II (1939-1945), with FL and NY also showing heightened inequality.\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# corrolation plot\nbiplot(GD_pca, scale = 0, cex = 0.55)\n```\n\n::: {.cell-output-display}\n![Correlation biplot 1929-1945](index_files/figure-html/fig-gd-biplot-1.png){#fig-gd-biplot fig-align='center' width=120%}\n:::\n:::\n\n### Distance biplot\n\nThe distance @fig-gd-dis-biplot distinctively groups states into nearly 4 clusters.\" biplot distinctively groups states into nearly 4 clusters. The closer distance between observation(States), States have more similar Gini index.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nbiplot(GD_pca, cex = 0.55)\n```\n\n::: {.cell-output-display}\n![Distance biplot 1929-1945](index_files/figure-html/fig-gd-dis-biplot-1.png){#fig-gd-dis-biplot fig-align='center' width=120%}\n:::\n:::\n\n\n## Global Financial crisis \n\n### Importance of PC\n\nFor the data spanning 2007 to 2015, we've selected PC1 and PC2 based on their standard deviations exceeding 1. Combined, they account for over 98% of the total variance.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n#####  GR ##########\nGR_pca<- GR_sf %>% \n  column_to_rownames('State') %>% \n  prcomp(scale. = TRUE)\n\n summary(GR_pca)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nImportance of components:\n                          PC1    PC2     PC3     PC4     PC5     PC6     PC7\nStandard deviation     2.6788 1.3022 0.19835 0.18431 0.16314 0.11831 0.08488\nProportion of Variance 0.7974 0.1884 0.00437 0.00377 0.00296 0.00156 0.00080\nCumulative Proportion  0.7974 0.9858 0.99014 0.99391 0.99687 0.99842 0.99922\n                           PC8     PC9\nStandard deviation     0.07188 0.04269\nProportion of Variance 0.00057 0.00020\nCumulative Proportion  0.99980 1.00000\n```\n:::\n:::\n\n\n\n### Screenplot\n\nThe elbow rule applied to the @fig-screeplot-gr further supports our choice, indicating that PC2 is an appropriate selection. \n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nscreeplot(GR_pca, type = \"l\")\n\n# Extract loadings\nloadings <- GR_pca$rotation[, 1:2]  # considering only PC1 and PC2\n```\n\n::: {.cell-output-display}\n![ Screeplot for PCs 2007-2015](index_files/figure-html/fig-screeplot-gr-1.png){#fig-screeplot-gr fig-align='center' width=120%}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ntransposed_loadings <- t(loadings)\ntransposed_df <- as.data.frame(transposed_loadings)\nrownames(transposed_df) <- c(\"PC1\", \"PC2\")\ncolnames(transposed_df) <- 2007:2015\n\n\ntransposed_df \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n          2007       2008       2009       2010       2011       2012\nPC1 -0.2335881 -0.2318800 -0.3395366 -0.3648976 -0.3580511 -0.3577311\nPC2 -0.5952369 -0.5995428 -0.3048751  0.1111107  0.1798640  0.1906366\n          2013       2014       2015\nPC1 -0.3595398 -0.3586613 -0.3593801\nPC2  0.1953757  0.1934789  0.1914368\n```\n:::\n:::\n\n### Correlation biplot\n\nUpon examining the correlation @fig-gr-biplot and the associated table, several observations stand out:\n\nFrom 2007 to 2009, there's a pronounced negative linear relationship between PC2 and each respective year. This is particularly evident in 2007 and 2008, where the relationship is strongly negative, and the values of PC2 are high. \n\nBetween 2010 and 2015, the relationship between PC2 and the corresponding year is relatively weaker and remains negative. These years also display a comparatively lower value of PC2.\n\nOver the entire period, there's a consistent negative linear relationship with PC1.\nPC1 and PC2 negativly affected by the Global Financial Crisis and this event lead to income inequality increase. In the post-Crisis, the inequality tend to decrease. \n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# corrolation plot\nbiplot(GR_pca, scale = 0, cex = 0.8)\n```\n\n::: {.cell-output-display}\n![Correlation biplot 2007-2015](index_files/figure-html/fig-gr-biplot-1.png){#fig-gr-biplot fig-align='center' width=120%}\n:::\n:::\n\n### Distance biplot\n\nIn the distance @fig-gr-dis-biplot, the Euclidean spacing between states like MA(Massachusetts) and NJ(New Jersey) or NV(Nevada) and CT(Connecticut) illustrates their comparative likeness or divergence. For instance, concerning the Gini index, closely spaced states likely followed similar trajectories or maintained consistent levels of income inequality over the years. \n\nConversely, NY(New York), FL(Florida) and MS(Mississippi) lie far from most other states might have unique or unusual trends in income inequality across the years, making them outliers.  \n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# distance plot \nbiplot(GR_pca, cex = 0.8)\n```\n\n::: {.cell-output-display}\n![Distance biplot 2007-2015](index_files/figure-html/fig-gr-dis-biplot-1.png){#fig-gr-dis-biplot fig-align='center' width=120%}\n:::\n:::\n\n\n\n\n# Conclusion and limitation \n\nOur MDS and PCA analysis revealed distinct patterns in U.S. income inequality across states and time periods. Our findings reveal that Connecticut ,Pennsylvania, Massachusetts exhibits the high level of inequality in the early year of Great Depression. In the middle and later of the World War II, Florida and New York demonstrate the highest levels of inequality. However, these insights come with caveats:\n\nThey simplify data interpretation by reducing dimensions, but this can result in information loss. PCA assumes linear relationships among variables, potentially missing non-linear patterns, while MDS outcomes depend on the chosen distance metric, leading to varying interpretations.\n\nSpecifically, MDS shows which states have similar inequality profiles, but not necessarily identical economic drivers. PCA identifies data patterns and correlations, like those between historical events and the Gini coefficient shifts, but can't determine causality.\n\nTo draw more in-depth and accurate conclusions, these findings should be integrated with other analytical techniques or domain expertise, such as add modeling analysis.  \n\n\n\n# Reference \n\nGoldin, C., & Margo, R. A. (1992). The Great Compression: The Wage Structure in the United States at Mid-century. The Quarterly Journal of Economics, 107(1), 1-34.\n\nHayes, A. (2023, May 27). Gini Index Explained and Gini Co-efficients Around the World. Investopedia. <https://www.investopedia.com/terms/g/gini-index.asp>.\n\nPiketty, T., & Saez, E. (2003). Income Inequality in the United States, 1913-1998. Quarterly Journal of Economics, 118(1), 1-41.\n\nPebesma, E., & Bivand, R. (2023). Spatial Data Science: With Applications in R. Chapman and Hall/CRC. <https://doi.org/10.1201/9780429459016>.\n\nPebesma, E., 2018. Simple Features for R: Standardized Support for Spatial Vector Data. The R Journal 10 (1), 439-446, <https://doi.org/10.32614/RJ-2018-009>.\n\nRobinson D, Hayes A, Couch S (2023). _broom: Convert Statistical Objects into Tidy Tibbles_. R package version 1.0.4, <https://CRAN.R-project.org/package=broom>.\n\nWickham H, Averick M, Bryan J, Chang W, McGowan LD, François R, Grolemund G, Hayes A, Henry L, Hester J, Kuhn M, Pedersen TL, Miller E, Bache SM, Müller K, Ooms J, Robinson D, Seidel DP, Spinu V, Takahashi K, Vaughan D, Wilke C, Woo K, Yutani H (2019). “Welcome to the tidyverse.”_Journal of Open Source Software_, *4*(43), 1686. doi:10.21105/joss.01686 <https://doi.org/10.21105/joss.01686>.\n  \nTierney N (2017). “visdat: Visualising Whole Data Frames.” _JOSS_, *2*(16), 355. doi:10.21105/joss.00355 <https://doi.org/10.21105/joss.00355>.\n\nH. Wickham. ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York, 2016.\n\nKassambara A (2023). _ggpubr: 'ggplot2' Based Publication Ready Plots_. R package version 0.6.0, <https://CRAN.R-project.org/package=ggpubr>.\n\nVenables, W. N. & Ripley, B. D. (2002) Modern Applied Statistics with S. Fourth Edition. Springer, New York.ISBN 0-387-95457-0\n\n\nZeileis A, Fisher JC, Hornik K, Ihaka R, McWhite CD, Murrell P, Stauffer R, Wilke CO (2020). “colorspace: A Toolbox for Manipulating and Assessing Colors and Palettes.” _Journal of Statistical Software_, *96*(1), 1-49. doi:10.18637/jss.v096.i01 <https://doi.org/10.18637/jss.v096.i01>.\n\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/htmlwidgets-1.6.2/htmlwidgets.js\"></script>\n<link href=\"../../site_libs/datatables-css-0.0.0/datatables-crosstalk.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/datatables-binding-0.28/datatables.js\"></script>\n<script src=\"../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js\"></script>\n<link href=\"../../site_libs/dt-core-1.13.4/css/jquery.dataTables.min.css\" rel=\"stylesheet\" />\n<link href=\"../../site_libs/dt-core-1.13.4/css/jquery.dataTables.extra.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/dt-core-1.13.4/js/jquery.dataTables.min.js\"></script>\n<link href=\"../../site_libs/crosstalk-1.2.0/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/crosstalk-1.2.0/js/crosstalk.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}